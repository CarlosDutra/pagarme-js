<html>
	<head>
		<title>Example page</title>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
		<script src="pagarme.js"></script>

		<script>
			$(document).ready(function() {
				PagarMe.encryption_key = "ek_test_Ec8KhxISQ1tug1b8bCGxC2nXfxqRmk";

				var form = $("#payment_form");

				form.submit(function(event) {
					var creditCard = new PagarMe.creditCard();
					creditCard.fillFromFrom(form);

					var fieldErrors = creditCard.fieldErrors();

					var hasErrors = false;
					for(var field in fieldErrors) { hasErrors = true; break; }

					$("#payment_form #card_number").css('border', '3px solid green');
					$("#payment_form #card_holder_name").css('border', '3px solid green');
					$("#payment_form #card_expiracy_month").css('border', '3px solid green');
					$("#payment_form #card_expiracy_year").css('border', '3px solid green');
					$("#payment_form #card_cvv").css('border', '3px solid green');

					if(hasErrors) {
						for(var fieldName in fieldErrors) {
							var field = $(form.find("#" + fieldName)[0]);
							field.css('border', '3px solid red');
						}

						return false;
					}

					creditCard.generateHash(function(cardHash) {
						console.log(cardHash);
						form.append($('<input type="hidden" name="card_hash"/>').val(cardHash));
						PagarMe.removeCardFieldsFromForm(form);
						form.get(0).submit();
					});

					return false;
				});
			});
		</script>
	</head>
	<body>
	<p style="background:url(https://api.pagar.me/1/profiling/fp/clear.png?org_id=k6dvnkdk&session_id=123123&m=1)"> </p>
	<img src="https://api.pagar.me/1/profiling/fp/clear.png?org_id=k6dvnkdk&session_id=123123&m=2" alt="" >
	<script src="https://api.pagar.me/1/profiling/fp/check.js?org_id=k6dvnkdk&session_id=123123" type="text/javascript">
	</script>
	<object type="application/x-shockwave-flash" data="https://api.pagar.me/1/profiling/fp/fp.swf?org_id=k6dvnkdk&session_id=123123" width="1" height="1" id="obj_id">
	<param name="movie" value="https://api.pagar.me/1/profiling/fp/fp.swf?org_id=k6dvnkdk&session_id=123123" /> </object>

		<form id="payment_form" action="https://api.pagar.me/1/transactions" method="POST">
			<input type="hidden" name="api_key" value="ak_test_KGXIjQ4GicOa2BLGZrDRTR5qNQxDWo"/>
			Valor: R$10,00 <input type="hidden" name="amount" value="1000"/>
			<br/>
			Nome: <input type="text" name="customer[name]" value="Pedro Franceschi"/>
			<br/>
			CPF: <input type="text" name="customer[document_number]" value="12388151708"/>
			<input type="hidden" name="customer[document_type]" value="cpf"/>
			<br/>
			Email: <input type="text" name="customer[email]" value="pedro@pagar.me"/>
			<br/>
			Logradouro: <input type="text" name="customer[address][street]" value="Av. Brigadeiro Faria Lima"/>
			<br/>
			Complemento: <input type="text" name="customer[address][street_2]" value="8 andar"/>
			<br/>
			Número: <input type="text" name="customer[address][street_number]" value="2941"/>
			<br/>
			Cidade: <input type="text" name="customer[address][city]" value="Sao Paulo"/>
			<br/>
			Estado: <input type="text" name="customer[address][state]" value="SP"/>
			<br/>
			Bairro: <input type="text" name="customer[address][neighborhood]" value="Itaim Bibi"/>
			<br/>
			CEP: <input type="text" name="customer[address][zipcode]" value="01452000"/>
			<br/>
			País: <input type="text" name="customer[address][country]" value="Brasil"/>
			<br/>
			<input type="hidden" name="customer[phone][type]" value="cellphone"/>
			Número de telefone: <input type="text" name="customer[phone][number]" value="87360795"/>
			<br/>
			DDD: <input type="text" name="customer[phone][ddd]" value="21"/>
			<br/>
			Sexo: <input type="text" name="customer[sex]" value="M"/>
			<br/>
			Data de nascimento: <input type="text" name="customer[born_at]" value="07-19-1993"/>
			<br/>
			<br/>
			Dados do cartão:
			<br/>
			Card number: <input type="text" id="card_number"/>
			<br/>
			Card holder name: <input type="text" id="card_holder_name"/>
			<br/>
			Card expiracy month: <input type="text" id="card_expiracy_month"/>
			<br/>
			Card expiracy year: <input type="text" id="card_expiracy_year"/>
			<br/>
			Card security code: <input type="text" id="card_cvv"/>
			<br/>
			<div id="field_errors">
			</div>
			<br/>
			<input type="submit"></input>
		</form>
	</body>
</html>
